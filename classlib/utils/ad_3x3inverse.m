function [ Ainv ] = ad_3x3inverse( A )
%AD_3X3INVERSE Summary of this function goes here
%   Detailed explanation goes here

i123 = [1;2;3];
i132 = [1;3;2];
i231 = [2;3;1];
i321 = [3;2;1];
i312 = [3;1;2];
i213 = [2;1;3];

detA = sum(A([i123;i132],1).*A([i231;i321],2).*[A(i312,3);-A(i213,3)]);
%detA = A(1,1)*A(2,2)*A(3,3) + A(2,1)*A(3,2)*A(1,3) + A(3,1)*A(1,2)*A(2,3) ...
%    - A(1,1)*A(3,2)*A(2,3) - A(3,1)*A(2,2)*A(1,3) - A(2,1)*A(1,2)*A(3,3);

% Ainv = [A(2,2)*A(3,3)-A(3,2)*A(2,3), A(3,2)*A(1,3)-A(1,2)*A(3,3),  A(1,2)*A(2,3)-A(2,2)*A(1,3)
%        A(2,3)*A(3,1)-A(3,3)*A(2,1), A(3,3)*A(1,1)-A(1,3)*A(3,1),  A(1,3)*A(2,1)-A(2,3)*A(1,1)
%        A(2,1)*A(3,2)-A(3,1)*A(2,2), A(3,1)*A(1,2)-A(1,1)*A(3,2),  A(1,1)*A(2,2)-A(2,1)*A(1,2)];
% 
% Ainvt = [A(2,2)*A(3,3), A(3,2)*A(2,3), A(3,2)*A(1,3), A(1,2)*A(3,3),  A(1,2)*A(2,3), A(2,2)*A(1,3)
%          A(2,3)*A(3,1), A(3,3)*A(2,1), A(3,3)*A(1,1), A(1,3)*A(3,1),  A(1,3)*A(2,1), A(2,3)*A(1,1)
%          A(2,1)*A(3,2), A(3,1)*A(2,2), A(3,1)*A(1,2), A(1,1)*A(3,2),  A(1,1)*A(2,2), A(2,1)*A(1,2)];
% 
Ainv = A([2 3 3 1 1 2],i231).*A([3 2 1 3 2 1],i312);
Ainv = Ainv';

Ainv = (Ainv(:,[1 3 5]) - Ainv(:,[2 4 6]))/detA;
    
end

